<!DOCTYPE HTML>
<html lang="en">
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Compatibility | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../naming/Naming.html">
    
    
    <link rel="prev" href="../security/Security.html">
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="5" data-chapter-title="Compatibility" data-filepath="compatibility/Compatibility.md" data-basepath=".." data-revision="Tue Apr 19 2016 06:28:25 GMT+0000 (UTC)" data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="1" data-path="TOC.html">
            
                
                    <a href="../TOC.html">
                
                        <i class="fa fa-check"></i>
                        
                            
                        
                        Table of Contents
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i><b>1.</b>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="design-principles/DesignPrinciples.html">
            
                
                    <a href="../design-principles/DesignPrinciples.html">
                
                        <i class="fa fa-check"></i><b>2.</b>
                        
                            
                        
                        Design Principles
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="general-guidelines/GeneralGuidelines.html">
            
                
                    <a href="../general-guidelines/GeneralGuidelines.html">
                
                        <i class="fa fa-check"></i><b>3.</b>
                        
                            
                        
                        General Guidelines
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="security/Security.html">
            
                
                    <a href="../security/Security.html">
                
                        <i class="fa fa-check"></i><b>4.</b>
                        
                            
                        
                        Security
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="5" data-path="compatibility/Compatibility.html">
            
                
                    <a href="../compatibility/Compatibility.html">
                
                        <i class="fa fa-check"></i><b>5.</b>
                        
                            
                        
                        Compatibility
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="naming/Naming.html">
            
                
                    <a href="../naming/Naming.html">
                
                        <i class="fa fa-check"></i><b>6.</b>
                        
                            
                        
                        Naming
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="http/Http.html">
            
                
                    <a href="../http/Http.html">
                
                        <i class="fa fa-check"></i><b>7.</b>
                        
                            
                        
                        HTTP
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="pagination/Pagination.html">
            
                
                    <a href="../pagination/Pagination.html">
                
                        <i class="fa fa-check"></i><b>8.</b>
                        
                            
                        
                        Pagination
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="hyper-media/Hypermedia.html">
            
                
                    <a href="../hyper-media/Hypermedia.html">
                
                        <i class="fa fa-check"></i><b>9.</b>
                        
                            
                        
                        Hypermedia
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="data-formats/DataFormats.html">
            
                
                    <a href="../data-formats/DataFormats.html">
                
                        <i class="fa fa-check"></i><b>10.</b>
                        
                            
                        
                        Data Formats
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="common-data-objects/CommonDataObjects.html">
            
                
                    <a href="../common-data-objects/CommonDataObjects.html">
                
                        <i class="fa fa-check"></i><b>11.</b>
                        
                            
                        
                        Common Data Objects
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="common-headers/CommonHeaders.html">
            
                
                    <a href="../common-headers/CommonHeaders.html">
                
                        <i class="fa fa-check"></i><b>12.</b>
                        
                            
                        
                        Common Headers
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="api-discovery/ApiDiscovery.html">
            
                
                    <a href="../api-discovery/ApiDiscovery.html">
                
                        <i class="fa fa-check"></i><b>13.</b>
                        
                            
                        
                        API Discovery
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../">Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="compatibility">Compatibility</h1>
<h2 id="must-dont-break-backward-compatibility"><span style="color:red;font-weight:bold">Must:</span> Don&#x2019;t Break Backward Compatibility</h2>
<p>Change APIs, but keep all consumers
running. Consumers usually have independent release lifecycles, focus on
stability, and avoid changes that do not provide additional value. APIs are
service contracts that cannot be broken via unilateral decisions.</p>
<p>There are two techniques to change APIs without breaking them:</p>
<ul>
<li>follow rules for compatible extensions</li>
<li>introduce new API versions and still support older versions</li>
</ul>
<p>We strongly encourage using compatible API extensions and discourage versioning.
With Postel&#x2019;s Law in mind, here are some rules for providers and consumers that
allow us to make compatible changes without versioning:</p>
<h2 id="should-prefer-compatible-extensions"><span style="color:darkgoldenrod;font-weight:bold">Should:</span> Prefer Compatible Extensions</h2>
<p>Apply the following rules to evolve RESTful APIs in a backward-compatible way:</p>
<ul>
<li>Ignore unknown fields in the payload</li>
<li>Add optional, non mandatory fields</li>
<li>Never change and only extend a field&#x2019;s meaning</li>
<li>Enum ranges cannot not be extended when used for output parameters &#x2014; clients
may not be prepared to handle it. However, enum ranges can be extended when
used for input parameters.</li>
<li>Enum ranges can be reduced when used as input parameters, only if the server
is ready to accept and handle old range values too. Enum values can be reduced
when used as output parameters.</li>
<li>Use x-extensible-enum, if range is used for output parameters and likely to
be extended with growing functionality. It defines an open list of explicit
values and clients must be agnostic to new values (e.g. via casuistic with
default behavior).</li>
<li>Support redirection in case an URL has to change
(<a href="https://en.wikipedia.org/wiki/HTTP_301" target="_blank">301 Moved Permanently</a>)</li>
</ul>
<h2 id="must-prepare-clients-for-compatible-api-extensions-the-robustness-principle"><span style="color:red;font-weight:bold">Must:</span> Prepare Clients for Compatible API Extensions (the Robustness Principle)</h2>
<p>How to do this:</p>
<ul>
<li>Ignore new and unknown fields in the payload (see also Fowler&#x2019;s
&#x201C;<a href="http://martinfowler.com/bliki/TolerantReader.html" target="_blank">TolerantReader</a>&#x201D; post)</li>
<li>Be prepared for new enum values declared with x-extensible-enum (see above);
provide default behavior for unknown values, if applicable</li>
<li>Follow the redirect when the server returns an &#x201C;HTTP 301 Moved Permanently&#x201D; response code</li>
</ul>
<h2 id="should-avoid-versioning"><span style="color:darkgoldenrod;font-weight:bold">Should:</span> Avoid Versioning</h2>
<p>When changing your RESTful APIs,
do so in a compatible way and avoid generating additional API versions. Multiple
versions can significantly complicate understanding, testing, maintaining,
evolving, operating and releasing our systems (<a href="http://martinfowler.com/articles/enterpriseREST.html" target="_blank">supplementary reading</a>).</p>
<p>If changing an API can&#x2019;t be done in a compatible way, then proceed in one of these
three ways:</p>
<ul>
<li>create a new resource (variant) in addition to the old resource variant</li>
<li>create a new service endpoint &#x2014; i.e. a new microservice application with a new API (variant)</li>
<li>create a new API version supported in parallel with the old API by the same microservice</li>
</ul>
<p>Avoiding versioning also means preferring the first two variants.</p>
<h2 id="must-use-media-type-versioning"><span style="color:red;font-weight:bold">Must:</span> Use Media Type Versioning</h2>
<p>When API versioning is unavoidable, you have to design your multi-version
RESTful APIs using media type versioning (instead of URI versioning, see below).
Media type versioning is less tightly coupled since it supports content
negotiation and hence reduces complexity of release management.</p>
<p>Media type versioning: Here, version information and media type are provided
together via the HTTP Content-Type header &#x2014; e.g.
application/x.zalando.cart+json;version=2. For incompatible changes, a new
media type version for the resource is created. To generate the new
representation version, consumer and producer can do content negotiation using
the HTTP Content-Type and Accept headers. Note: This versioning only applies to
the content schema, not to URI or method semantics.</p>
<p>In this example, a client wants only the new version:</p>
<pre><code>Content-Type: application/x.zalando.cart+json;version=2
Accept: application/x.zalando.cart+json;version=2
</code></pre><p>Using header versioning should:</p>
<ul>
<li>include versions in request and response headers to increase visibility</li>
<li>include Content-Type in the Vary header to enable proxy caches to differ between versions</li>
</ul>
<p>Hint: <a href="https://github.com/OAI/OpenAPI-Specification/issues/146" target="_blank">OpenAPI currently doesn&#x2019;t support content
negotiation</a>, though <a href="https://github.com/OAI/OpenAPI-Specification/issues/146#issuecomment-117288707" target="_blank">a comment in this
issue</a> mentions
a workaround (using a fragment identifier that
gets stripped off).</p>
<h2 id="must-do-not-use-uri-versioning"><span style="color:red;font-weight:bold">Must:</span> Do Not Use URI Versioning</h2>
<p>With URI versioning a (major) version number is included in the path, e.g.
/v1/customers. The consumer has to wait until the provider has been released
and deployed. If the consumer also supports hypermedia links &#x2014; even in their
APIs &#x2014; to drive workflows (HATEOAS), this quickly becomes complex. So does
coordinating version upgrades &#x2014; especially with hyperlinked service
dependencies &#x2014; when using URL versioning. To avoid this tighter coupling and
complexer release management we do not use URI versioning, and go instead with
media type versioning and content negotiation (see above).</p>
<h2 id="should-provide-version-information-in-openapi-documentation"><span style="color:darkgoldenrod;font-weight:bold">Should:</span> Provide Version Information in OpenAPI Documentation</h2>
<p>Only the documentation, not the API itself, needs version information.</p>
<p>Example:</p>
<pre><code>&quot;swagger&quot;: &quot;2.0&quot;,
&quot;info&quot;: {
  &quot;title&quot;: &quot;Parcel service API&quot;,
  &quot;description&quot;: &quot;API for &lt;...&gt;&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
    &lt;...&gt;
}
</code></pre><p>During a (possibly) long-running API review phase you need different versions
of the API description. These versions may include changes that are incompatible
with earlier draft versions. So we apply the following version schema
MAJOR.MINOR.DRAFT that increments the...</p>
<ul>
<li>MAJOR version, when you make incompatible API changes</li>
<li>MINOR version, when you add functionality in a backwards-compatible manner</li>
<li>DRAFT version, when you make changes during the review phase that are not
related to production releases</li>
</ul>
<p>We recommend using the DRAFT version only for unreleased API definitions that
are still under review; for example:</p>
<pre><code>version 1.4.0  -- current version
version 1.4.1  -- first draft and call for review of API extensions compatible with 1.4.0
version 1.4.2  -- second draft and call for review of API extensions that are still compatible
                   with 1.4.0 but possibly incompatible with 1.4.1
version 1.5.0  -- approved version for implementation and release
version 1.5.1  -- first draft for next review and API change cycle;
                   compatible with 1.4.0 and 1.5.0
</code></pre><p>Hint: This versioning scheme differs in the less strict DRAFT aspect from
<a href="http://semver.org" target="_blank">semantic version information</a> used for released APIs and
service applications.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../security/Security.html" class="navigation navigation-prev " aria-label="Previous page: Security"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../naming/Naming.html" class="navigation navigation-next " aria-label="Next page: Naming"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"structured-toc":{},"gitbook-restructure-navigation":{"transformations":[{"from":0,"to":1}]},"restructure-navigation":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
